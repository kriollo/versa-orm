<?xml version="1.0"?>
<psalm
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns="https://getpsalm.org/schema/config"
    xsi:schemaLocation="https://getpsalm.org/schema/config vendor/vimeo/psalm/config.xsd"
    errorLevel="3"
    phpVersion="8.3"
    cacheDirectory="vendor/cache/psalm"
    ensureArrayStringOffsetsExist="true"
    findUnusedVariablesAndParams="false"
    findUnusedCode="false"
    strictBinaryOperands="true"
    reportMixedIssues="true"
>
    <projectFiles>
        <directory name="src" />
        <ignoreFiles>
            <directory name="vendor" />
            <directory name="src/binary" />
        </ignoreFiles>
    </projectFiles>

    <!-- Plugins deshabilitados: el plugin de seguridad no estÃ¡ disponible para Psalm 5. Usamos reglas de Tainted* igualmente. -->

    <issueHandlers>
        <!-- Security issues should be treated as errors -->
        <TaintedInput errorLevel="error" />
        <TaintedSql errorLevel="error" />
        <TaintedShell errorLevel="error" />
        <TaintedFile errorLevel="error" />
        <TaintedHtml errorLevel="error" />
        <TaintedCookie errorLevel="error" />
        <TaintedHeader errorLevel="error" />
        <ForbiddenCode errorLevel="suppress" />

        <!-- Allow mixed types in some cases -->
        <MixedAssignment errorLevel="info" />
        <MixedArgument errorLevel="info" />
        <MixedArrayOffset errorLevel="info" />
        <MixedMethodCall errorLevel="info" />
        <MixedPropertyFetch errorLevel="info" />

        <!-- Strict type checking -->
    <RedundantCondition errorLevel="info" />
        <UnresolvableInclude errorLevel="error" />
    <InvalidDocblock errorLevel="error" />
    <InvalidCast errorLevel="info" />
    <TypeDoesNotContainType errorLevel="info" />
    <RedundantCast errorLevel="info" />
    <PossiblyUndefinedArrayOffset errorLevel="info" />

        <!-- Allow some flexibility for dynamic features -->
        <UndefinedMagicMethod errorLevel="info" />
        <UndefinedMagicPropertyFetch errorLevel="info" />
        <UndefinedMagicPropertyAssignment errorLevel="info" />

        <!-- Library noise reductions -->
        <PossiblyUnusedMethod errorLevel="suppress" />
        <UnusedClass errorLevel="suppress" />
        <UnusedMethod errorLevel="suppress" />
        <UnusedMethodCall errorLevel="info" />
        <UnusedVariable errorLevel="info" />
        <UnusedForeachValue errorLevel="info" />
        <PossiblyUnusedProperty errorLevel="info" />
        <PossiblyUnusedReturnValue errorLevel="info" />
        <UnnecessaryVarAnnotation errorLevel="info" />
        <PossiblyUndefinedStringArrayOffset errorLevel="info" />
        <InvalidOperand errorLevel="info" />
    </issueHandlers>
</psalm>
